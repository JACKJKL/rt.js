/*! rtemplate.js 2014-05-04 */
!function(a,b){if("object"==typeof exports&&exports)b(exports);else{var c={};b(c),"function"==typeof define&&define.amd?define(c):a.rTemplate=c}}(this,function(a){"use strict";function b(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function c(a){return(""+a).replace(/[&<>"'\/\\%]/g,function(a){return k[a]})}function d(a){if(!j(a)||2!==a.length)throw new Error("Invalid tags: "+a);return[new RegExp(b(a[0])+"\\s*"),new RegExp("\\s*"+b(a[1]))]}function e(b,c){c=c||a.tags,b=b||"","string"==typeof c&&(c=c.split(o));for(var e,f,i,j,k=d(c),l=new h(b),m=[];!l.eos()&&(e=l.pos,i=l.scanUntil(k[0]),i&&(m.push(["text",i,e,e+i.length]),e+=i.length),l.scan(k[0]));){if(f=l.scan(q)||"name",l.scan(n),"@"===f?(i=l.scanUntil(p),l.scan(p),l.scanUntil(k[1])):i=l.scanUntil(k[1]),!l.scan(k[1]))throw new Error("Unclosed tag at "+l.pos);j=[f,i,e,l.pos],m.push(j),"@"===f&&(k=d(c=i.split(o)))}return g(m)}function f(a){return";(function() { "+e(a)+"})();"}function g(b){for(var c="var output = '';",d=0,e=b.length;e>d;d++){var f=b[d];if(f){var g=f[1],h=/text|\^|%/;switch(h.test(f[0])&&(g=g.replace(l,function(a){return"\\"+m[a]})),f[0]){case"name":c+=g+"\n";break;case">":c+="output+="+a.include(g);break;case"=":c+="output+=utils.escape("+g+")\n";break;case"&":c+="output+="+g+";\n";break;case"%":case"text":c+="output+='"+g+"';\n"}}}return c+="return output;",console.log(c),c}function h(a){this.string=a,this.tail=a,this.pos=0}var i=(RegExp.prototype.test,Object.prototype.toString),j=Array.isArray||function(a){return"[object Array]"===i.call(a)},k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","\\":"&#x5c;","%":"&#x0025;"},l=/\\|'|"|\r|\n|\u2028|\u2029/g,m={"'":"'",'"':'"',"\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},n=/\s*/,o=/\s+/,p=/\s*@/,q=/#|&|=|@|>|%/;a.supportInclude=function(a){this.include=function(b){return f(a(b))}},a.supportInclude(function(a){var b,c="";try{b=document.getElementById(a),c=b?b.innerHTML:""}catch(d){}return c}),h.prototype.eos=function(){return""===this.tail},h.prototype.scan=function(a){var b=this.tail.match(a);if(b&&0===b.index){var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c}return""},h.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},a.version="0.2",a.tags=["<%","%>"],a.cache={},a.utils={escape:c,include:f},a.compile=function(b,c){var d;if(this.cache&&(d=this.cache[c]||this.cache[b]))return d;var f=e(b),g=new Function("context","utils",f);return d=function(b){return g(b,a.utils)},c?this.cache[c]=d:this.cache[b]=d},a.render=function(a,b,c){var d=this.compile(a,c);return d(b)}});
//# sourceMappingURL=rtemplate.js.map